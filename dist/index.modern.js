import{Context as t}from"@hotwired/stimulus";class e{constructor(t,e){this.identifier=t,this.name=e[0],this.descriptor=e[1],this.options=e[2]||{}}get description(){return this.descriptor.includes("->")?this.descriptor.replace(/->/,`->${this.identifier}#`):`${this.identifier}#${this.descriptor}`}}class r{constructor(t){this.context=t,this.controller=t.controller;let e=function(t,e){let r=function(t){const e=[];for(;t;)e.push(t),t=Object.getPrototypeOf(t);return e.reverse()}(t);return Array.from(r.reduce((t,e)=>(function(t,e){const r=t.actions;return Array.isArray(r)?r:[]}(e).forEach(e=>t.add(e)),t),new Set))}(this.controller.constructor);this.actions=this.compile(e)}compile(t){return t.map(t=>new e(this.controller.identifier,t))}run(){this.actions.forEach(t=>{this.resolveTargets(t).forEach(e=>{this.attachAction(e,t)})})}resolveTargets(t){let e=this.findTargets(t.name);return t.options.if?this.filterTargets(e,t.options.if):e}findTargets(t){return"element"==t?[this.controller.element]:this.controller[`${t}Targets`]?[].concat(this.controller[`${t}Targets`]):[]}filterTargets(t,e){return t.filter(t=>{let r=this.controller[e];return"function"==typeof r&&(r=r.apply(this.controller,t)),0!=r})}attachAction(t,e){let r=e.description,i=(t.dataset.action||"").split(" ");i.some(t=>t==r)||i.push(r),t.dataset.action=i.join(" ").trim()}}let i=t.prototype.connect,o=t.prototype.targetConnected;t.prototype.connect=function(){return this.actionSetter=new r(this),this.actionSetter.run(),i.apply(this,arguments)},t.prototype.targetConnected=function(){return this.actionSetter.run(),o.apply(this,arguments)};
//# sourceMappingURL=index.modern.js.map
